_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, _BYTE *a2)
{
  _BYTE *v2; // rax
  _BYTE *v3; // rax
  bool v5; // [rsp+0h] [rbp-22h]
  bool v6; // [rsp+1h] [rbp-21h]
  _BYTE *v7; // [rsp+2h] [rbp-20h]
  char i; // [rsp+Eh] [rbp-14h]

  while ( 1 )
  {
    v6 = 0;
    if ( a2 )
      v6 = *a2 != 0;
    if ( !v6 )
      break;
    v2 = a1++;
    v7 = v2;
    for ( i = 0; ; ++i )
    {
      v5 = 0;
      if ( *a2 )
        v5 = *a2 != 46;
      if ( !v5 )
        break;
      v3 = a1++;
      *v3 = *a2++;
    }
    *v7 = i;
    if ( *a2 )
      ++a2;
  }
  return a1;
}
