_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, _BYTE *a2, unsigned int a3)
{
  _BYTE *result; // $v0
  _BYTE *v4; // $v1
  _BYTE *i; // $a3
  int v6; // $a0
  char v7; // $t0
  _BYTE *v8; // $t0

  result = a1;
  while ( 2 )
  {
    if ( a2 )
    {
      if ( *a2 )
      {
        v4 = result + 1;
        if ( !a3 || a3 >= (unsigned int)v4 )
        {
          for ( i = a2; ; ++i )
          {
            v6 = (char)*i;
            v7 = (_BYTE)i - (_BYTE)a2;
            if ( !*i )
              break;
            if ( v6 == 46 )
            {
              *result = v7;
              goto LABEL_9;
            }
            v8 = v4 + 1;
            if ( a3 && a3 < (unsigned int)v8 )
              return v4;
            ++v4;
            *(v8 - 1) = v6;
          }
          *result = v7;
LABEL_9:
          result = v4;
          a2 = &i[*i != 0];
          continue;
        }
      }
    }
    return result;
  }
}
