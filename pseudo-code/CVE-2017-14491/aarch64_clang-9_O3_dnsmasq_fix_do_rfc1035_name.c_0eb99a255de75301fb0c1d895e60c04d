_BYTE *__fastcall do_rfc1035_name(_BYTE *result, unsigned __int8 *a2, unsigned __int64 a3)
{
  unsigned __int8 v3; // w10
  _BYTE *v4; // x8
  __int64 v5; // x9
  int v6; // w12
  _BYTE *v7; // x11
  unsigned __int8 v8; // w9
  __int64 v9; // x8
  int v10; // w11

  if ( a2 )
  {
    if ( a3 )
    {
      while ( 1 )
      {
        v3 = *a2;
        v4 = result;
        if ( !*a2 || (unsigned __int64)(result + 1) > a3 )
          break;
        v5 = 0LL;
        v6 = *a2;
        v7 = result;
        if ( *a2 )
        {
          while ( v6 != 46 )
          {
            if ( (unsigned __int64)&result[v5 + 2] > a3 )
            {
              result += v5 + 1;
              return result;
            }
            v7[1] = v3;
            v3 = a2[++v5];
            v6 = v3;
            v7 = &result[v5];
            if ( !v3 )
              break;
          }
        }
        *result = v5;
        result = v7 + 1;
        if ( a2[v5] )
          a2 += v5 + 1;
        else
          a2 += v5;
        if ( !a2 )
          return &v4[v5 + 1];
      }
    }
    else
    {
      do
      {
        v8 = *a2;
        if ( !*a2 )
          break;
        v9 = 0LL;
        v10 = *a2;
        if ( *a2 )
        {
          do
          {
            if ( v10 == 46 )
              break;
            result[v9 + 1] = v8;
            v8 = a2[++v9];
            v10 = v8;
          }
          while ( v8 );
        }
        *result = v9;
        result += v9 + 1;
        a2 += a2[v9] ? v9 + 1 : v9;
      }
      while ( a2 );
    }
  }
  return result;
}
