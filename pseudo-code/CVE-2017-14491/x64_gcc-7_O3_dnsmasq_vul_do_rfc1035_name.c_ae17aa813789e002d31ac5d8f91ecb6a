_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, char *a2)
{
  char v2; // cl
  _BYTE *result; // rax
  char *v4; // rdx

  if ( !a2 )
    return a1;
  v2 = *a2;
  if ( !*a2 )
    return a1;
  result = a1 + 1;
  v4 = a2;
  if ( v2 != 46 )
    goto LABEL_6;
LABEL_11:
  for ( *a1 = 0; *v4; *a1 = (_BYTE)v4 - (_BYTE)a2 )
  {
    LOBYTE(a2) = (_BYTE)v4 + 1;
    if ( v4 == (char *)-1LL )
      break;
    v2 = v4[1];
    if ( !v2 )
      break;
    a1 = result;
    ++v4;
    ++result;
    if ( v2 == 46 )
      goto LABEL_11;
    do
    {
LABEL_6:
      ++v4;
      *result++ = v2;
      v2 = *v4;
    }
    while ( *v4 && v2 != 46 );
  }
  return result;
}
