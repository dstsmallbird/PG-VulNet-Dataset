_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, _BYTE *a2, unsigned __int64 a3)
{
  _BYTE *v3; // x8
  _BYTE *v4; // x8
  bool v6; // [xsp+8h] [xbp-38h]
  bool v7; // [xsp+Ch] [xbp-34h]
  _BYTE *v8; // [xsp+10h] [xbp-30h]
  char i; // [xsp+1Ch] [xbp-24h]

  while ( 1 )
  {
    v7 = 0;
    if ( a2 )
      v7 = *a2 != 0;
    if ( !v7 )
      break;
    if ( a3 && (unsigned __int64)(a1 + 1) > a3 )
      return a1;
    v3 = a1++;
    v8 = v3;
    for ( i = 0; ; ++i )
    {
      v6 = 0;
      if ( *a2 )
        v6 = *a2 != 46;
      if ( !v6 )
        break;
      if ( a3 && (unsigned __int64)(a1 + 1) > a3 )
        return a1;
      v4 = a1++;
      *v4 = *a2++;
    }
    *v8 = i;
    if ( *a2 )
      ++a2;
  }
  return a1;
}
