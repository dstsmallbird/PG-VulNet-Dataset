_BYTE *__cdecl do_rfc1035_name(_BYTE *a1, char *a2, unsigned int a3)
{
  _BYTE *v3; // ebp
  char *v4; // edi
  char v5; // dl
  char *v6; // ecx
  char v7; // si
  _BYTE *result; // eax

  v3 = a1;
  v4 = a2;
  if ( !a2 )
    return a1;
  if ( !*a2 )
    return a1;
  while ( 1 )
  {
    if ( a3 && a3 < (unsigned int)(v3 + 1) )
      return v3;
    result = v3 + 1;
    v5 = *v4;
    if ( *v4 )
    {
      if ( v5 != 46 )
        break;
    }
    v6 = v4;
    v7 = 0;
LABEL_16:
    *v3 = v7;
    if ( !*v6 )
      return result;
    v4 = v6 + 1;
    if ( v6 == (char *)-1 || !v6[1] )
      return result;
    v3 = result;
  }
  v6 = v4;
  while ( !a3 || a3 >= (unsigned int)(result + 1) )
  {
    *result++ = v5;
    v7 = (_BYTE)++v6 - (_BYTE)v4;
    v5 = *v6;
    if ( !*v6 || v5 == 46 )
      goto LABEL_16;
  }
  return result;
}
