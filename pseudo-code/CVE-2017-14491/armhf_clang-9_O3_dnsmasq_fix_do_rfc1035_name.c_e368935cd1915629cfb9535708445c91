_BYTE *__fastcall do_rfc1035_name(_BYTE *result, char *a2, unsigned int a3)
{
  char v3; // r12
  int i; // lr
  char *v5; // r3
  bool v6; // zf
  _BYTE *v7; // r3
  int v8; // t1
  int j; // r3
  char *v10; // r0
  char v11; // r0
  bool v12; // zf
  int v13; // t1
  _BYTE *v14; // r12

  if ( a2 )
  {
    if ( a3 )
    {
      while ( 1 )
      {
        v3 = *a2;
        if ( !*a2 || (unsigned int)(result + 1) > a3 )
          break;
        for ( i = 0; ; ++i )
        {
          v6 = v3 == 0;
          v7 = &result[i];
          if ( v3 )
            v6 = v3 == 46;
          if ( v6 )
            break;
          if ( (unsigned int)(v7 + 2) > a3 )
            return v7 + 1;
          v7[1] = v3;
          v5 = &a2[i];
          v3 = v5[1];
        }
        *result = i;
        v8 = (unsigned __int8)a2[i];
        a2 += i;
        result += i + 1;
        if ( v8 )
          ++a2;
        if ( !a2 )
          return v7 + 1;
      }
    }
    else
    {
      do
      {
        v14 = result;
        v11 = *a2;
        if ( !*a2 )
          return v14;
        for ( j = 0; ; ++j )
        {
          v12 = v11 == 0;
          if ( v11 )
            v12 = v11 == 46;
          if ( v12 )
            break;
          v14[j + 1] = v11;
          v10 = &a2[j];
          v11 = v10[1];
        }
        *v14 = j;
        v13 = (unsigned __int8)a2[j];
        a2 += j;
        result = &v14[j + 1];
        if ( v13 )
          ++a2;
      }
      while ( a2 );
      result = &v14[j + 1];
    }
  }
  return result;
}
