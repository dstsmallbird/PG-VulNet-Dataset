__int64 __fastcall do_rfc1035_name(__int64 a1, char *a2, unsigned __int64 a3)
{
  __int64 result; // rax
  _BYTE *v4; // r8
  char v5; // al
  __int64 v6; // rdi
  __int64 v7; // rax

  result = a1;
  if ( a2 )
  {
    while ( 1 )
    {
      v4 = (_BYTE *)result;
      v5 = *a2;
      if ( !*a2 || a3 && (unsigned __int64)(v4 + 1) > a3 )
        break;
      v6 = 0LL;
      while ( v5 && v5 != 46 )
      {
        if ( a3 && (unsigned __int64)&v4[v6 + 2] > a3 )
          return (__int64)&v4[v6 + 1];
        v4[v6 + 1] = v5;
        v5 = a2[++v6];
      }
      *v4 = v6;
      v7 = (__int64)&a2[v6 + 1];
      a2 += v6;
      if ( *(_BYTE *)(v7 - 1) )
        a2 = (char *)v7;
      result = (__int64)&v4[v6 + 1];
      if ( !a2 )
        return (__int64)&v4[v6 + 1];
    }
    result = (__int64)v4;
  }
  return result;
}
