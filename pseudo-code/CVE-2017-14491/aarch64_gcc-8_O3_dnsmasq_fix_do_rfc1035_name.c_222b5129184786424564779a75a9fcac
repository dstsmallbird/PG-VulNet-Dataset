_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, _BYTE *a2, unsigned __int64 a3)
{
  int v4; // w3
  _BYTE *result; // x0
  char v6; // w5
  int v7; // t1
  bool v8; // zf
  _BYTE *v9; // x4
  int v10; // t1
  bool v11; // zf
  _BYTE *v12; // x4

  if ( !a2 )
    return a1;
  v4 = (unsigned __int8)*a2;
  if ( !*a2 )
    return a1;
  while ( 1 )
  {
    result = a1 + 1;
    if ( !a3 )
    {
      v6 = 0;
      if ( v4 != 46 )
      {
        do
        {
          *result++ = v4;
          ++v6;
          v10 = (unsigned __int8)*++a2;
          v4 = v10;
          if ( v10 == 46 )
            v11 = 1;
          else
            v11 = v4 == 0;
        }
        while ( !v11 );
        v9 = result;
LABEL_20:
        result = v9;
      }
      goto LABEL_21;
    }
    if ( a3 < (unsigned __int64)result )
      return a1;
    v6 = 0;
    if ( v4 != 46 )
      break;
LABEL_21:
    *a1 = v6;
    v12 = a2;
    if ( !*a2 )
      return result;
    if ( !++a2 )
      return result;
    v4 = (unsigned __int8)v12[1];
    if ( !v12[1] )
      return result;
    a1 = result;
  }
  while ( 1 )
  {
    v9 = result + 1;
    ++v6;
    if ( (unsigned __int64)(result + 1) > a3 )
      return result;
    *result++ = v4;
    v7 = (unsigned __int8)*++a2;
    v4 = v7;
    if ( v7 == 46 )
      v8 = 1;
    else
      v8 = v4 == 0;
    if ( v8 )
      goto LABEL_20;
  }
}
