_BYTE *__cdecl do_rfc1035_name(_BYTE *a1, _BYTE *a2, unsigned int a3)
{
  _BYTE *v3; // ebp
  _BYTE *v4; // ecx
  _BYTE *result; // eax
  char v6; // si
  char v7; // dl
  _BYTE *v8; // edx

  v3 = a1;
  v4 = a2;
  if ( !a2 )
    return a1;
  if ( !*a2 )
    return a1;
  while ( 1 )
  {
    if ( a3 && a3 < (unsigned int)(v3 + 1) )
      return v3;
    result = v3 + 1;
    v7 = *v4;
    if ( *v4 )
    {
      if ( v7 != 46 )
        break;
    }
    v8 = v4;
    v6 = 0;
LABEL_10:
    *v3 = v6;
    if ( !*v8 )
      return result;
    v4 = v8 + 1;
    if ( v8 == (_BYTE *)-1 || !v8[1] )
      return result;
    v3 = result;
  }
  while ( !a3 || a3 >= (unsigned int)(result + 1) )
  {
    *result++ = v7;
    ++v4;
    v6 = (_BYTE)result + ~(_BYTE)v3;
    v7 = *v4;
    if ( !*v4 || v7 == 46 )
    {
      v8 = v4;
      goto LABEL_10;
    }
  }
  return result;
}
