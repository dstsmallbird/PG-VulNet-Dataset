_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, unsigned __int8 *a2)
{
  unsigned __int8 v2; // $a2
  int v3; // $t0
  int v4; // $v1
  unsigned __int8 *v5; // $at
  _BYTE *v6; // $v1

  if ( a2 )
  {
    while ( 1 )
    {
      v2 = *a2;
      if ( !*a2 )
        break;
      v3 = *a2;
      v4 = 0;
      if ( *a2 )
      {
        do
        {
          if ( v3 == 46 )
            break;
          a1[v4 + 1] = v2;
          v2 = a2[v4 + 1];
          v3 = v2;
          ++v4;
        }
        while ( v2 );
      }
      *a1 = v4;
      v5 = &a2[v4];
      a2 += v4 + 1;
      if ( !*v5 )
        a2 = v5;
      v6 = &a1[v4];
      a1 = v6 + 1;
      if ( !a2 )
        return v6 + 1;
    }
  }
  return a1;
}
