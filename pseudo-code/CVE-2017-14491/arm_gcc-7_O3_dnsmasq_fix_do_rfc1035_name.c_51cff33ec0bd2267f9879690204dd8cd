_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, _BYTE *a2, unsigned int a3)
{
  _BYTE *v3; // r5
  int v4; // r12
  _BYTE *result; // r0
  unsigned __int8 *v6; // r1
  _BYTE *v7; // r3
  _BYTE *v8; // r4
  int v9; // t1
  char v10; // lr
  bool v11; // zf
  unsigned __int8 *v12; // r1
  int v13; // t1
  bool v14; // zf

  v3 = a1;
  if ( !a2 )
    return v3;
  v4 = (unsigned __int8)*a2;
  if ( !*a2 )
    return v3;
  result = a1 + 1;
  if ( !a3 )
    goto LABEL_18;
LABEL_4:
  if ( (unsigned int)result > a3 )
    return v3;
  if ( v4 == 46 )
  {
    while ( 1 )
    {
      v8 = a2;
      v10 = 0;
LABEL_14:
      *v3 = v10;
      if ( !*v8 )
        break;
      a2 = v8 + 1;
      if ( v8 == (_BYTE *)-1 )
        break;
      v4 = (unsigned __int8)v8[1];
      if ( !v8[1] )
        break;
      v3 = result++;
      if ( a3 )
        goto LABEL_4;
LABEL_18:
      if ( v4 != 46 )
      {
        v7 = result;
        v12 = a2 + 1;
        do
        {
          *v7++ = v4;
          v8 = v12;
          v13 = *v12++;
          v4 = v13;
          v10 = (_BYTE)v7 - 1 - (_BYTE)v3;
          v14 = v13 == 0;
          if ( v13 )
            v14 = v4 == 46;
        }
        while ( !v14 );
LABEL_13:
        result = v7;
        goto LABEL_14;
      }
    }
  }
  else
  {
    v6 = a2 + 1;
    while ( 1 )
    {
      v7 = result + 1;
      if ( (unsigned int)(result + 1) > a3 )
        break;
      *result = v4;
      v8 = v6;
      v9 = *v6++;
      v4 = v9;
      v10 = (_BYTE)v7 + ~(_BYTE)v3;
      v11 = v9 == 0;
      if ( v9 )
        v11 = v4 == 46;
      ++result;
      if ( v11 )
        goto LABEL_13;
    }
  }
  return result;
}
