_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, char *a2)
{
  char v2; // cl
  _BYTE *result; // rax
  char v4; // r8
  char *v5; // rdx

  if ( a2 )
  {
    while ( 1 )
    {
      v2 = *a2;
      if ( !*a2 )
        break;
      result = a1 + 1;
      v4 = 0;
      v5 = a2 + 1;
      while ( v2 && v2 != 46 )
      {
        *result = v2;
        v2 = *v5++;
        ++v4;
        ++result;
      }
      *a1 = v4;
      a2 = v5 - 1;
      if ( *(v5 - 1) )
        a2 = v5;
      a1 = result;
      if ( !a2 )
        return result;
    }
  }
  return a1;
}
