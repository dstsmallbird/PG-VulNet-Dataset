_BYTE *__fastcall do_rfc1035_name(_BYTE *result, _BYTE *a2)
{
  _BYTE *v2; // r2
  _BYTE *i; // r3
  int v4; // r12
  bool v5; // zf

  for ( ; a2 && *a2; result = i )
  {
    v2 = a2;
    for ( i = result + 1; ; ++i )
    {
      v4 = (unsigned __int8)*v2;
      a2 = v2;
      v5 = v4 == 0;
      if ( *v2 )
        v5 = v4 == 46;
      ++v2;
      if ( v5 )
        break;
      *i = v4;
    }
    *result = (_BYTE)i + ~(_BYTE)result;
    if ( *a2 )
      a2 = v2;
  }
  return result;
}
