_BYTE *__cdecl do_rfc1035_name(_BYTE *a1, char *a2, unsigned int a3)
{
  _BYTE *result; // eax
  _BYTE *v5; // edx
  char *i; // ecx
  char v7; // bl
  _BYTE *v8; // edi

  result = a1;
LABEL_2:
  if ( a2 )
  {
    if ( *a2 )
    {
      v5 = result + 1;
      if ( !a3 || a3 >= (unsigned int)v5 )
      {
        for ( i = a2; ; ++i )
        {
          v7 = *i;
          if ( !*i || v7 == 46 )
          {
            *result = (_BYTE)i - (_BYTE)a2;
            result = v5;
            a2 = &i[-(*i == 0) + 1];
            goto LABEL_2;
          }
          v8 = v5 + 1;
          if ( a3 )
          {
            if ( a3 < (unsigned int)v8 )
              break;
          }
          ++v5;
          *(v8 - 1) = v7;
        }
        result = v5;
      }
    }
  }
  return result;
}
