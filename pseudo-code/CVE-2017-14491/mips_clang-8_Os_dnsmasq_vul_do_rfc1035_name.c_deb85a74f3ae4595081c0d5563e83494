_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, char *a2)
{
  char v2; // $a2
  int v3; // $v1
  char *v4; // $at
  _BYTE *v5; // $v1

  if ( a2 )
  {
    while ( 1 )
    {
      v2 = *a2;
      if ( !*a2 )
        break;
      v3 = 0;
      while ( v2 && v2 != 46 )
      {
        a1[v3 + 1] = v2;
        v2 = a2[++v3];
      }
      *a1 = v3;
      v4 = &a2[v3];
      a2 += v3 + 1;
      if ( !*v4 )
        a2 = v4;
      v5 = &a1[v3];
      a1 = v5 + 1;
      if ( !a2 )
        return v5 + 1;
    }
  }
  return a1;
}
