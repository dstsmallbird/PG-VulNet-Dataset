_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, char *a2)
{
  _BYTE *result; // $v0
  char *v3; // $a2
  char v4; // $a1
  int v5; // $v1

  result = a1;
  if ( a2 )
  {
    if ( *a2 )
    {
      do
      {
        v5 = *a2;
        result = a1 + 1;
        if ( *a2 )
        {
          v3 = a2;
          if ( v5 == 46 )
          {
            v4 = 0;
          }
          else
          {
            result = a1 + 2;
            while ( 1 )
            {
              *(result - 1) = v5;
              ++v3;
              v4 = (_BYTE)result - 1 - (_BYTE)a1;
              v5 = *v3;
              if ( !*v3 )
                break;
              ++result;
              if ( v5 == 46 )
              {
                --result;
                *a1 = v4;
                goto LABEL_6;
              }
            }
          }
        }
        else
        {
          v3 = a2;
          v4 = 0;
        }
        *a1 = v4;
LABEL_6:
        a2 = v3 + 1;
        if ( !*v3 )
          break;
        if ( v3 == (char *)-1 )
          break;
        a1 = result;
      }
      while ( v3[1] );
    }
    else
    {
      result = a1;
    }
  }
  return result;
}
