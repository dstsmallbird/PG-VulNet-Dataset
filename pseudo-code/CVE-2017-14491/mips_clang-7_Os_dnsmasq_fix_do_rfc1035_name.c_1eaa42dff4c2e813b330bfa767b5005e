_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, char *a2, unsigned int a3)
{
  char v3; // $v1
  int i; // $a3
  _BYTE *v5; // $t0
  char *v6; // $at

  if ( a2 )
  {
    while ( 1 )
    {
      v3 = *a2;
      if ( !*a2 || a3 && a3 < (unsigned int)(a1 + 1) )
        break;
      for ( i = 0; ; ++i )
      {
        v5 = &a1[i];
        if ( !v3 || v3 == 46 )
          break;
        if ( a3 && a3 < (unsigned int)(v5 + 2) )
          return v5 + 1;
        v5[1] = v3;
        v3 = a2[i + 1];
      }
      *a1 = i;
      v6 = &a2[i];
      a2 += i + 1;
      if ( !*v6 )
        a2 = v6;
      a1 = v5 + 1;
      if ( !a2 )
        return v5 + 1;
    }
  }
  return a1;
}
