_BYTE *__fastcall do_rfc1035_name(_BYTE *result, _BYTE *a2, unsigned int a3)
{
  _BYTE *v3; // r3
  int v4; // lr
  bool v5; // zf
  _BYTE *v6; // r12

  if ( a2 )
  {
    if ( *a2 )
    {
      v3 = result + 1;
      if ( !a3 || a3 >= (unsigned int)v3 )
      {
        while ( 1 )
        {
          v6 = a2;
          while ( 1 )
          {
            v4 = (unsigned __int8)*v6;
            a2 = v6;
            v5 = v4 == 0;
            if ( *v6 )
              v5 = v4 == 46;
            ++v6;
            if ( v5 )
              break;
            if ( a3 && a3 < (unsigned int)(v3 + 1) )
              return v3;
            *v3++ = v4;
          }
          *result = ~(_BYTE)result + (_BYTE)v3;
          if ( *a2 )
            a2 = v6;
          result = v3;
          if ( !a2 )
            break;
          if ( !*a2 )
            break;
          ++v3;
          if ( a3 )
          {
            if ( a3 < (unsigned int)v3 )
              break;
          }
        }
      }
    }
  }
  return result;
}
