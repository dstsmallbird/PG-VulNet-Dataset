int __cdecl do_rfc1035_name(int a1, char *a2, unsigned int a3)
{
  char *v3; // edi
  int result; // eax
  _BYTE *v5; // esi
  char v6; // al
  int v7; // ebx
  char *v8; // eax
  bool v9; // zf

  v3 = a2;
  result = a1;
  if ( a2 )
  {
    while ( 1 )
    {
      v5 = (_BYTE *)result;
      v6 = *v3;
      if ( !*v3 || a3 && (unsigned int)(v5 + 1) > a3 )
        break;
      v7 = 0;
      while ( v6 && v6 != 46 )
      {
        if ( a3 && (unsigned int)&v5[v7 + 2] > a3 )
          return (int)&v5[v7 + 1];
        v5[v7 + 1] = v6;
        v6 = v3[++v7];
      }
      *v5 = v7;
      v8 = &v3[v7];
      v9 = v3[v7] == 0;
      v3 += v7 + 1;
      if ( v9 )
        v3 = v8;
      result = (int)&v5[v7 + 1];
      if ( !v3 )
        return (int)&v5[v7 + 1];
    }
    result = (int)v5;
  }
  return result;
}
