_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, _BYTE *a2, unsigned int a3)
{
  int v4; // r12
  _BYTE *v5; // lr
  _BYTE *result; // r0
  char v7; // r4
  unsigned __int8 *v8; // r1
  _BYTE *v9; // r3
  int v10; // t1
  bool v11; // zf
  unsigned __int8 *v12; // r5
  int v13; // t1
  bool v14; // zf

  if ( !a2 )
    return a1;
  v4 = (unsigned __int8)*a2;
  if ( !*a2 )
    return a1;
  if ( !a3 )
    goto LABEL_18;
LABEL_4:
  if ( a3 < (unsigned int)(a1 + 1) )
    return a1;
  if ( v4 == 46 )
  {
    v5 = a2;
    result = a1 + 1;
    v7 = 0;
    goto LABEL_14;
  }
  result = a1 + 1;
  v8 = a2 + 1;
  while ( 1 )
  {
    v9 = result + 1;
    if ( a3 < (unsigned int)(result + 1) )
      return result;
    *result = v4;
    v5 = v8;
    v10 = *v8++;
    v4 = v10;
    v7 = (_BYTE)result - (_BYTE)a1;
    v11 = v10 == 0;
    if ( v10 )
      v11 = v4 == 46;
    ++result;
    if ( v11 )
    {
LABEL_13:
      result = v9;
LABEL_14:
      while ( 1 )
      {
        *a1 = v7;
        if ( !*v5 )
          return result;
        a2 = v5 + 1;
        if ( v5 == (_BYTE *)-1 )
          return result;
        v4 = (unsigned __int8)v5[1];
        if ( !v5[1] )
          return result;
        a1 = result;
        if ( a3 )
          goto LABEL_4;
LABEL_18:
        v9 = a1 + 1;
        if ( v4 != 46 )
        {
          v12 = a2 + 1;
          do
          {
            *v9++ = v4;
            v5 = v12;
            v7 = (_BYTE)v12 - (_BYTE)a2;
            v13 = *v12++;
            v4 = v13;
            v14 = v13 == 0;
            if ( v13 )
              v14 = v4 == 46;
          }
          while ( !v14 );
          goto LABEL_13;
        }
        v5 = a2;
        result = a1 + 1;
        v7 = 0;
      }
    }
  }
}
