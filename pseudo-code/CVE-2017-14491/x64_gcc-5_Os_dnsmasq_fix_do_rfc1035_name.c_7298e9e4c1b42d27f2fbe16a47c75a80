_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, char *a2, unsigned __int64 a3)
{
  _BYTE *result; // rax
  _BYTE *v4; // rcx
  char *i; // r8
  char v6; // di
  _BYTE *v7; // r9

  result = a1;
LABEL_2:
  if ( a2 )
  {
    if ( *a2 )
    {
      v4 = result + 1;
      if ( !a3 || a3 >= (unsigned __int64)v4 )
      {
        for ( i = a2; ; ++i )
        {
          v6 = *i;
          if ( !*i || v6 == 46 )
          {
            *result = (_BYTE)i - (_BYTE)a2;
            result = v4;
            a2 = &i[-(*i == 0) + 1];
            goto LABEL_2;
          }
          v7 = v4 + 1;
          if ( a3 )
          {
            if ( a3 < (unsigned __int64)v7 )
              break;
          }
          ++v4;
          *(v7 - 1) = v6;
        }
        result = v4;
      }
    }
  }
  return result;
}
