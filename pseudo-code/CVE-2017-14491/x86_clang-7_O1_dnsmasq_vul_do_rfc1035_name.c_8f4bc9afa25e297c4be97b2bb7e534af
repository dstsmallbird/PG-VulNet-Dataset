_BYTE *__cdecl do_rfc1035_name(_BYTE *a1, char *a2)
{
  char *v2; // edi
  char v4; // dl
  _BYTE *result; // eax
  char v6; // bl
  char *i; // esi

  v2 = a2;
  if ( a2 )
  {
    while ( 1 )
    {
      v4 = *v2;
      if ( !*v2 )
        break;
      result = a1 + 1;
      v6 = 0;
      for ( i = v2 + 1; v4; ++result )
      {
        if ( v4 == 46 )
          break;
        *result = v4;
        v4 = *i++;
        ++v6;
      }
      *a1 = v6;
      v2 = i - 1;
      if ( *(i - 1) )
        v2 = i;
      a1 = result;
      if ( !v2 )
        return result;
    }
  }
  return a1;
}
