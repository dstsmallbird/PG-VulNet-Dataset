_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, _BYTE *a2, unsigned int a3)
{
  int i; // $a3
  _BYTE *v4; // $t1
  int v5; // $t0
  _BYTE *v6; // $v1

  if ( a2 )
  {
    while ( *a2 && (!a3 || a3 >= (unsigned int)(a1 + 1)) )
    {
      for ( i = 0; ; ++i )
      {
        v4 = &a2[i];
        v5 = (unsigned __int8)a2[i];
        v6 = &a1[i];
        if ( !a2[i] || v5 == 46 )
          break;
        if ( a3 && a3 < (unsigned int)(v6 + 2) )
          return v6 + 1;
        v6[1] = v5;
      }
      *a1 = i;
      a2 = v4 + 1;
      if ( !*v4 )
        a2 = v4;
      a1 = v6 + 1;
      if ( !a2 )
        return v6 + 1;
    }
  }
  return a1;
}
