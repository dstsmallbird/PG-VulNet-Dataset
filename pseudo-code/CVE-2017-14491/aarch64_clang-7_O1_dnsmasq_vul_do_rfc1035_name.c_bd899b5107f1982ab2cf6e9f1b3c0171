_BYTE *__fastcall do_rfc1035_name(_BYTE *result, unsigned __int8 *a2)
{
  unsigned __int8 v2; // w9
  __int64 v3; // x8
  int v4; // w11

  for ( ; a2; a2 += a2[v3] ? v3 + 1 : v3 )
  {
    v2 = *a2;
    if ( !*a2 )
      break;
    v3 = 0LL;
    v4 = *a2;
    if ( *a2 )
    {
      do
      {
        if ( v4 == 46 )
          break;
        result[v3 + 1] = v2;
        v2 = a2[++v3];
        v4 = v2;
      }
      while ( v2 );
    }
    *result = v3;
    result += v3 + 1;
  }
  return result;
}
