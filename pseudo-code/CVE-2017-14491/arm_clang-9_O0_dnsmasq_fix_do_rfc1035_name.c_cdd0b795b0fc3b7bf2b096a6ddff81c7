_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, char *a2, unsigned int a3)
{
  char v3; // r0
  _BYTE *v4; // r0
  _BYTE *v5; // r1
  bool v7; // [sp+0h] [bp-20h]
  char v8; // [sp+4h] [bp-1Ch]
  char i; // [sp+Ch] [bp-14h]

  while ( 1 )
  {
    v8 = 0;
    if ( a2 )
    {
      v3 = *a2;
      if ( *a2 )
        v3 = 1;
      v8 = v3;
    }
    if ( (v8 & 1) == 0 )
      break;
    if ( a3 && (unsigned int)(a1 + 1) > a3 )
      return a1;
    v4 = a1++;
    for ( i = 0; ; ++i )
    {
      v7 = 0;
      if ( *a2 )
        v7 = *a2 != 46;
      if ( !v7 )
        break;
      if ( a3 && (unsigned int)(a1 + 1) > a3 )
        return a1;
      v5 = a1++;
      *v5 = *a2++;
    }
    *v4 = i;
    if ( *a2 )
      ++a2;
  }
  return a1;
}
