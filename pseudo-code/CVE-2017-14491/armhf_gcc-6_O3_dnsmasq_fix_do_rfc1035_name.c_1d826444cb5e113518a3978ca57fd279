_BYTE *__fastcall do_rfc1035_name(_BYTE *result, _BYTE *a2, unsigned int a3)
{
  _BYTE *v3; // r12
  int v4; // r4
  _BYTE *v5; // r5
  char v6; // r6
  unsigned __int8 *v7; // r1
  int v8; // t1
  bool v9; // zf
  _BYTE *v10; // r3
  unsigned __int8 *v11; // r7
  int v12; // t1
  bool v13; // zf

  v3 = result;
  if ( !a2 )
    return result;
  v4 = (unsigned __int8)*a2;
  if ( !*a2 )
    return v3;
  while ( !a3 )
  {
    v10 = v3 + 1;
    if ( v4 == 46 )
    {
      v5 = a2;
      result = v3 + 1;
      v6 = 0;
    }
    else
    {
      v11 = a2 + 1;
      do
      {
        *v10++ = v4;
        v5 = v11;
        v6 = (_BYTE)v11 - (_BYTE)a2;
        v12 = *v11++;
        v4 = v12;
        v13 = v12 == 0;
        if ( v12 )
          v13 = v4 == 46;
      }
      while ( !v13 );
LABEL_20:
      result = v10;
    }
LABEL_21:
    *v3 = v6;
    if ( !*v5 )
      return result;
    a2 = v5 + 1;
    if ( v5 == (_BYTE *)-1 )
      return result;
    v4 = (unsigned __int8)v5[1];
    if ( !v5[1] )
      return result;
    v3 = result;
  }
  if ( a3 < (unsigned int)(v3 + 1) )
    return v3;
  if ( v4 == 46 )
  {
    v5 = a2;
    result = v3 + 1;
    v6 = 0;
    goto LABEL_21;
  }
  v7 = a2 + 1;
  result = v3 + 1;
  while ( 1 )
  {
    v10 = result + 1;
    v5 = v7;
    v6 = (_BYTE)result - (_BYTE)v3;
    if ( a3 < (unsigned int)(result + 1) )
      return result;
    *result++ = v4;
    v8 = *v7++;
    v4 = v8;
    v9 = v8 == 0;
    if ( v8 )
      v9 = v4 == 46;
    if ( v9 )
      goto LABEL_20;
  }
}
