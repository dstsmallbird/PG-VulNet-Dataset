_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, unsigned __int8 *a2)
{
  unsigned __int8 v2; // $a2
  unsigned __int8 *v3; // $at
  _BYTE *v4; // $v1
  int v5; // $t0
  int i; // $v1

  if ( a2 )
  {
    v2 = *a2;
    if ( *a2 )
    {
      while ( 1 )
      {
        v5 = v2;
        for ( i = 0; v2; ++i )
        {
          if ( v5 == 46 )
            break;
          a1[i + 1] = v2;
          v2 = a2[i + 1];
          v5 = v2;
        }
        *a1 = i;
        v3 = &a2[i];
        a2 += i + 1;
        if ( !*v3 )
          a2 = v3;
        v4 = &a1[i];
        a1 = v4 + 1;
        if ( !a2 )
          break;
        v2 = *a2;
        if ( !*a2 )
          return a1;
      }
      a1 = v4 + 1;
    }
  }
  return a1;
}
