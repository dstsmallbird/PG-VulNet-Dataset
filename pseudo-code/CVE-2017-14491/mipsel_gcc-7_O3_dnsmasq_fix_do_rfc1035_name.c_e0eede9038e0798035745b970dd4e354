_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, _BYTE *a2, unsigned int a3)
{
  int v3; // $v1
  _BYTE *result; // $v0
  char v5; // $t0
  _BYTE *i; // $a3
  _BYTE *v7; // $t2

  if ( a2 )
  {
    v3 = (char)*a2;
    if ( *a2 )
    {
      while ( 1 )
      {
        result = a1 + 1;
        if ( a3 )
        {
          if ( a3 < (unsigned int)result )
            break;
        }
        v5 = 0;
        if ( v3 == 46 )
        {
          v7 = a2;
        }
        else
        {
          if ( a3 )
          {
            for ( i = a1 + 2; ; ++i )
            {
              ++a2;
              if ( a3 < (unsigned int)i )
                break;
              *(i - 1) = v3;
              v5 = (_BYTE)i + ~(_BYTE)a1;
              v3 = (char)*a2;
              result = i;
              if ( !*a2 || v3 == 46 )
                goto LABEL_16;
            }
            return result;
          }
          while ( 1 )
          {
            *result++ = v3;
            v3 = (char)*++a2;
            v5 = (_BYTE)result - 1 - (_BYTE)a1;
            if ( !*a2 )
              break;
            i = result;
            if ( v3 == 46 )
              goto LABEL_16;
          }
          i = result;
LABEL_16:
          v7 = a2;
          result = i;
        }
        *a1 = v5;
        if ( *a2++ )
        {
          if ( a2 )
          {
            v3 = (char)v7[1];
            a1 = result;
            if ( v7[1] )
              continue;
          }
        }
        return result;
      }
    }
  }
  return a1;
}
