_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, _BYTE *a2)
{
  char v2; // dl
  _BYTE *result; // rax
  char v4; // cl
  _BYTE *i; // rdx

  if ( !a2 )
    return a1;
  v2 = *a2;
  if ( !*a2 )
    return a1;
  result = a1 + 1;
  if ( v2 == 46 )
    goto LABEL_11;
LABEL_4:
  v4 = 0;
  do
  {
    ++result;
    ++a2;
    *(result - 1) = v2;
    ++v4;
    v2 = *a2;
  }
  while ( *a2 && v2 != 46 );
  *a1 = v4;
  for ( i = a2; *a2; *a1 = 0 )
  {
    if ( !++a2 )
      break;
    v2 = i[1];
    if ( !v2 )
      break;
    a1 = result++;
    if ( v2 != 46 )
      goto LABEL_4;
LABEL_11:
    i = a2;
  }
  return result;
}
