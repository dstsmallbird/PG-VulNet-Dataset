int __cdecl do_rfc1035_name(int a1, _BYTE *a2, unsigned int a3)
{
  _BYTE *v3; // esi
  int result; // eax
  _BYTE *v5; // edx
  int i; // ebx
  char v7; // al
  bool v8; // zf
  _BYTE *v9; // eax

  v3 = a2;
  result = a1;
  if ( a2 )
  {
    while ( 1 )
    {
      v5 = (_BYTE *)result;
      if ( !*v3 || a3 && result + 1 > a3 )
        break;
      for ( i = 0; ; ++i )
      {
        v7 = v3[i];
        if ( !v7 || v7 == 46 )
          break;
        if ( a3 && (unsigned int)&v5[i + 2] > a3 )
          return (int)&v5[i + 1];
        v5[i + 1] = v7;
      }
      *v5 = i;
      v8 = v3[i] == 0;
      v9 = &v3[i];
      v3 += i + 1;
      if ( v8 )
        v3 = v9;
      result = (int)&v5[i + 1];
      if ( !v3 )
        return (int)&v5[i + 1];
    }
  }
  return result;
}
