_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, _BYTE *a2, unsigned int a3)
{
  int v3; // $a3
  _BYTE *v4; // $t1
  char v5; // $t0
  _BYTE *result; // $v0
  _BYTE *v7; // $v1
  _BYTE *v8; // $v0
  _BYTE *v9; // $a3

  if ( a2 )
  {
    v3 = (char)*a2;
    if ( *a2 )
    {
      while ( 1 )
      {
        v4 = a1 + 1;
        if ( a3 )
        {
          if ( a3 < (unsigned int)v4 )
            break;
        }
        v5 = 0;
        if ( v3 == 46 )
        {
          v9 = a2;
          result = a1 + 1;
        }
        else
        {
          if ( a3 )
          {
            result = a1 + 1;
            while ( 1 )
            {
              v7 = result + 1;
              ++a2;
              if ( a3 < (unsigned int)(result + 1) )
                return result;
              *result = v3;
              v5 = (_BYTE)v7 - (_BYTE)v4;
              v3 = (char)*a2;
              ++result;
              if ( !*a2 || v3 == 46 )
                goto LABEL_17;
            }
          }
          v8 = a2;
          while ( 1 )
          {
            *v4++ = v3;
            v3 = (char)*++v8;
            v5 = (_BYTE)v8 - (_BYTE)a2;
            if ( !*v8 )
              break;
            v7 = v4;
            if ( v3 == 46 )
              goto LABEL_16;
          }
          v7 = v4;
LABEL_16:
          a2 = v8;
LABEL_17:
          v9 = a2;
          result = v7;
        }
        *a1 = v5;
        if ( *a2++ )
        {
          if ( a2 )
          {
            v3 = (char)v9[1];
            a1 = result;
            if ( v3 )
              continue;
          }
        }
        return result;
      }
    }
  }
  return a1;
}
