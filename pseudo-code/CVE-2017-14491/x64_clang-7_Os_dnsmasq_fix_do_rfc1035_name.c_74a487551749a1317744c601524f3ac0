__int64 __fastcall do_rfc1035_name(_BYTE *a1, char *a2, unsigned __int64 a3)
{
  _BYTE *v3; // r8
  char v4; // al
  __int64 v5; // rcx
  __int64 v6; // rax

  if ( a2 )
  {
    while ( 1 )
    {
      v3 = a1;
      v4 = *a2;
      if ( !*a2 || a3 && (unsigned __int64)(a1 + 1) > a3 )
        break;
      v5 = 0LL;
      while ( v4 && v4 != 46 )
      {
        if ( a3 && (unsigned __int64)&a1[v5 + 2] > a3 )
          return (__int64)&v3[v5 + 1];
        a1[v5 + 1] = v4;
        v4 = a2[++v5];
      }
      *a1 = v5;
      v6 = (__int64)&a2[v5 + 1];
      a2 += v5;
      if ( *(_BYTE *)(v6 - 1) )
        a2 = (char *)v6;
      a1 += v5 + 1;
      if ( !a2 )
        return (__int64)&v3[v5 + 1];
    }
  }
  return (__int64)a1;
}
