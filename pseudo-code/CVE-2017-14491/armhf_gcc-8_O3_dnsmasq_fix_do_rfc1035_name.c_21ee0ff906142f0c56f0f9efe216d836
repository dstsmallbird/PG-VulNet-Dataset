_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, _BYTE *a2, unsigned int a3)
{
  int v4; // r4
  _BYTE *result; // r0
  unsigned __int8 *v6; // r1
  int v7; // t1
  bool v8; // zf
  _BYTE *v9; // r3
  _BYTE *v10; // r6
  char v11; // r5
  unsigned __int8 *v12; // r1
  int v13; // t1
  bool v14; // zf

  if ( !a2 )
    return a1;
  v4 = (unsigned __int8)*a2;
  if ( !*a2 )
    return a1;
  while ( 1 )
  {
    result = a1 + 1;
    if ( a3 )
      break;
    if ( v4 == 46 )
      goto LABEL_25;
    v12 = a2 + 1;
    v9 = a1 + 1;
    do
    {
      ++v9;
      v10 = v12;
      *(v9 - 1) = v4;
      v11 = (_BYTE)v9 - 1 - (_BYTE)a1;
      v13 = *v12++;
      v4 = v13;
      v14 = v13 == 46;
      if ( v13 != 46 )
        v14 = v4 == 0;
    }
    while ( !v14 );
LABEL_20:
    result = v9;
LABEL_21:
    *a1 = v11;
    if ( !*v10 )
      return result;
    a2 = v10 + 1;
    if ( v10 == (_BYTE *)-1 )
      return result;
    v4 = (unsigned __int8)v10[1];
    if ( !v10[1] )
      return result;
    a1 = result;
  }
  if ( a3 < (unsigned int)result )
    return a1;
  if ( v4 == 46 )
  {
LABEL_25:
    v10 = a2;
    v11 = 0;
    goto LABEL_21;
  }
  v6 = a2 + 1;
  while ( 1 )
  {
    v9 = result + 1;
    v10 = v6;
    v11 = (_BYTE)result + 1 + ~(_BYTE)a1;
    if ( (unsigned int)(result + 1) > a3 )
      return result;
    *result++ = v4;
    v7 = *v6++;
    v4 = v7;
    v8 = v7 == 0;
    if ( v7 )
      v8 = v4 == 46;
    if ( v8 )
      goto LABEL_20;
  }
}
