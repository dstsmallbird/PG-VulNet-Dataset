_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, char *a2, unsigned __int64 a3)
{
  _BYTE *result; // rax
  char v4; // r8
  __int64 v5; // rcx
  __int64 v6; // r8
  char v7; // cl
  char v8; // r8
  char *i; // rdx

  if ( !a2 )
    return a1;
  if ( a3 )
  {
    while ( 1 )
    {
      result = a1;
      v4 = *a2;
      if ( !*a2 || (unsigned __int64)(a1 + 1) > a3 )
        break;
      v5 = 0LL;
      if ( v4 )
      {
        while ( v4 != 46 )
        {
          if ( (unsigned __int64)&a1[v5 + 2] > a3 )
            goto LABEL_14;
          a1[v5 + 1] = v4;
          v4 = a2[++v5];
          if ( !v4 )
            break;
        }
      }
      *a1 = v5;
      v6 = (__int64)&a2[v5 + 1];
      if ( !a2[v5] )
        v6 = (__int64)&a2[v5];
      a1 += v5 + 1;
      a2 = (char *)v6;
      if ( !v6 )
      {
LABEL_14:
        result += v5 + 1;
        return result;
      }
    }
  }
  else
  {
    while ( 1 )
    {
      v7 = *a2;
      if ( !*a2 )
        break;
      result = a1 + 1;
      v8 = 0;
      for ( i = a2 + 1; v7; ++v8 )
      {
        if ( v7 == 46 )
          break;
        *result = v7;
        v7 = *i++;
        ++result;
      }
      *a1 = v8;
      a2 = i - 1;
      if ( *(i - 1) )
        a2 = i;
      a1 = result;
      if ( !a2 )
        return result;
    }
    result = a1;
  }
  return result;
}
