_BYTE *__cdecl do_rfc1035_name(_BYTE *a1, _BYTE *a2, unsigned int a3)
{
  _BYTE *result; // eax
  _BYTE *v5; // ecx
  int i; // edx
  char v7; // bl

  result = a1;
LABEL_2:
  if ( a2 )
  {
    if ( *a2 )
    {
      v5 = result + 1;
      if ( !a3 || a3 >= (unsigned int)v5 )
      {
        for ( i = 0; ; ++i )
        {
          v7 = a2[i];
          if ( !v7 || v7 == 46 )
          {
            *result = i;
            result = v5;
            a2 = &a2[i + 1 - (a2[i] == 0)];
            goto LABEL_2;
          }
          if ( a3 && a3 < (unsigned int)(v5 + 1) )
            break;
          *v5++ = v7;
        }
        result = v5;
      }
    }
  }
  return result;
}
