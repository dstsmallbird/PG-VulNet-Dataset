_BYTE *__fastcall do_rfc1035_name(_BYTE *result, char *a2, unsigned __int64 a3)
{
  char v3; // w10
  _BYTE *v4; // x8
  __int64 i; // x9
  _BYTE *v6; // x11

  if ( a2 )
  {
    while ( 1 )
    {
      v3 = *a2;
      v4 = result;
      if ( !*a2 || a3 && (unsigned __int64)(result + 1) > a3 )
        break;
      for ( i = 0LL; ; ++i )
      {
        v6 = &result[i];
        if ( !v3 || v3 == 46 )
          break;
        if ( a3 && (unsigned __int64)&result[i + 2] > a3 )
          return &v4[i + 1];
        v6[1] = v3;
        v3 = a2[i + 1];
      }
      *result = i;
      result = v6 + 1;
      if ( a2[i] )
        a2 += i + 1;
      else
        a2 += i;
      if ( !a2 )
        return &v4[i + 1];
    }
  }
  return result;
}
