_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, _BYTE *a2, unsigned int a3)
{
  _BYTE *v3; // r12
  _BYTE *result; // r0
  int v5; // r4
  bool v6; // zf
  char v7; // r6
  unsigned __int8 *v8; // r1
  bool v9; // zf
  _BYTE *v10; // r5

  v3 = a1;
  if ( !a2 )
    return v3;
  if ( !*a2 )
    return v3;
  result = a1 + 1;
  if ( a3 )
  {
    if ( (unsigned int)result > a3 )
      return v3;
  }
  while ( 1 )
  {
    v5 = (unsigned __int8)*a2;
    v6 = v5 == 46;
    if ( v5 != 46 )
      v6 = v5 == 0;
    if ( !v6 )
      break;
    v7 = 0;
    v10 = a2;
LABEL_16:
    *v3 = v7;
    if ( !*v10 )
      return result;
    a2 = v10 + 1;
    if ( v10 == (_BYTE *)-1 || !v10[1] )
      return result;
    v3 = result++;
    if ( a3 && (unsigned int)result > a3 )
      return v3;
  }
  v8 = a2 + 1;
  while ( 1 )
  {
    v10 = v8;
    v7 = (_BYTE)result + 1 + ~(_BYTE)v3;
    if ( a3 )
    {
      if ( (unsigned int)(result + 1) > a3 )
        return result;
    }
    *result++ = v5;
    v5 = *v8++;
    v9 = v5 == 0;
    if ( v5 )
      v9 = v5 == 46;
    if ( v9 )
      goto LABEL_16;
  }
}
