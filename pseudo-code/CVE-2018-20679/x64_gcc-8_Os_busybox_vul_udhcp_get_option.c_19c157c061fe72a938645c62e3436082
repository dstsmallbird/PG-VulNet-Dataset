_BYTE *__fastcall udhcp_get_option(_BYTE *a1, int a2, __int64 a3, __int64 a4, __int64 a5, int a6)
{
  __int64 v6; // rcx
  _BYTE *v7; // rbx
  int v8; // eax
  int v9; // er8
  __int64 v10; // rbx

  v6 = 0LL;
  v7 = a1 + 240;
  v8 = 388;
  while ( 1 )
  {
    while ( 1 )
    {
      LOBYTE(v9) = *v7;
      if ( *v7 )
        break;
      --v8;
      ++v7;
LABEL_4:
      if ( !v8 )
        goto LABEL_5;
    }
    if ( (_BYTE)v9 != 0xFF )
      break;
    if ( (v6 & 0x101) == 1 )
    {
      v6 = (unsigned int)v6 | 0x101;
      v7 = a1 + 108;
      v8 = 128;
    }
    else
    {
      if ( (v6 & 0x202) != 2 )
      {
        v10 = 0LL;
        if ( (unsigned int)dhcp_verbose > 2 )
          bb_error_msg((unsigned int)"option 0x%02x not found", a2, a3, v6, -1, a6);
        return (_BYTE *)v10;
      }
      v6 = (unsigned int)v6 | 0x202;
      v7 = a1 + 44;
      v8 = 64;
    }
  }
  if ( v8 == 1 || (a3 = (unsigned int)(unsigned __int8)v7[1] + 2, v8 -= a3, v8 < 0) )
  {
LABEL_5:
    v10 = 0LL;
    bb_error_msg((unsigned int)"bad packet, malformed option field", a2, a3, v6, v9, a6);
    return (_BYTE *)v10;
  }
  a6 = (unsigned __int8)v9;
  if ( (unsigned __int8)v9 != a2 )
  {
    if ( v7[1] && (_BYTE)v9 == 52 )
    {
      v9 = (unsigned __int8)v7[2];
      v6 = v9 | (unsigned int)v6;
    }
    v7 += (int)a3;
    goto LABEL_4;
  }
  if ( (unsigned int)dhcp_verbose > 1 )
    log_option_part_0("option found", v7, a3, v6);
  return v7 + 2;
}
