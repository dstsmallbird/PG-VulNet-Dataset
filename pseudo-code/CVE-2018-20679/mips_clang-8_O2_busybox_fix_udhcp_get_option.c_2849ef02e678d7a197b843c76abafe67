int __fastcall udhcp_get_option(int a1, int a2)
{
  int v2; // $v0
  int v3; // $v1
  int v4; // $s1
  int v5; // $t3
  int v6; // $a0
  int v7; // $a2
  int v8; // $s2
  unsigned __int8 *v9; // $s3
  int v10; // $t4
  int v11; // $a2
  int v12; // $s0
  char v14[516]; // [sp+10h] [-204h] BYREF

  v2 = a1 + 108;
  v3 = a1 + 44;
  v4 = a1 + 240;
  v5 = 388;
  v6 = 0;
  while ( 1 )
  {
    v7 = 1;
    v8 = 0;
    while ( 1 )
    {
      v9 = (unsigned __int8 *)(v4 + v7);
      v10 = *(unsigned __int8 *)(v4 + v7 - 1);
      if ( *(_BYTE *)(v4 + v7 - 1) )
        break;
      --v8;
      ++v7;
      if ( v5 + v8 + 1 < 2 )
        goto LABEL_23;
    }
    if ( v10 == 255 )
    {
      if ( (v6 & 0x101) == 1 )
      {
        v6 |= 0x101u;
        v5 = 128;
        v4 = v2;
        continue;
      }
      if ( (v6 & 0x202) == 2 )
      {
        v6 |= 0x202u;
        v5 = 64;
        v4 = v3;
        continue;
      }
      v12 = 0;
      if ( (unsigned int)dhcp_verbose >= 3 )
        bb_error_msg("option 0x%02x not found", a2);
      return v12;
    }
    if ( v5 + v8 < 2 )
      goto LABEL_23;
    v11 = *v9;
    v5 = v5 - v11 + v8 - 2;
    if ( v5 < 0 )
      goto LABEL_23;
    if ( v10 == a2 )
      break;
    if ( v10 == 52 && *v9 )
      v6 |= v9[1];
    v4 = v4 + v11 - v8 + 2;
    if ( v5 <= 0 )
      goto LABEL_23;
  }
  if ( !*v9 )
  {
LABEL_23:
    bb_error_msg("bad packet, malformed option field");
    return 0;
  }
  if ( (unsigned int)dhcp_verbose >= 2 )
  {
    *(_BYTE *)bin2hex(v14, v4 - v8 + 2) = 0;
    bb_error_msg("%s: 0x%02x %s", "option found", *(v9 - 1), v14);
  }
  return v4 - v8 + 2;
}
