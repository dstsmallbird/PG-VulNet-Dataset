_BYTE *__fastcall udhcp_get_option(_BYTE *a1, int a2, __int64 a3, __int64 a4, __int64 a5, int a6)
{
  _BYTE *v6; // rbx
  __int64 v7; // rcx
  int v8; // eax
  int v9; // er8
  __int64 v10; // rbx

  v6 = a1 + 240;
  v7 = 0LL;
  v8 = 388;
  while ( 1 )
  {
    while ( 1 )
    {
      LOBYTE(v9) = *v6;
      if ( *v6 )
        break;
      --v8;
      ++v6;
LABEL_4:
      if ( !v8 )
        goto LABEL_5;
    }
    if ( (_BYTE)v9 != 0xFF )
      break;
    if ( (v7 & 0x101) == 1 )
    {
      v7 = (unsigned int)v7 | 0x101;
      v6 = a1 + 108;
      v8 = 128;
    }
    else
    {
      if ( (v7 & 0x202) != 2 )
      {
        v10 = 0LL;
        if ( (unsigned int)dhcp_verbose > 2 )
          bb_error_msg((unsigned int)"option 0x%02x not found", a2, a3, v7, -1, a6);
        return (_BYTE *)v10;
      }
      v7 = (unsigned int)v7 | 0x202;
      v6 = a1 + 44;
      v8 = 64;
    }
  }
  if ( v8 == 1 || (a3 = (unsigned int)(unsigned __int8)v6[1] + 2, v8 -= a3, v8 < 0) )
  {
LABEL_5:
    v10 = 0LL;
    bb_error_msg((unsigned int)"bad packet, malformed option field", a2, a3, v7, v9, a6);
    return (_BYTE *)v10;
  }
  a6 = (unsigned __int8)v9;
  if ( a2 != (unsigned __int8)v9 )
  {
    if ( v6[1] && (_BYTE)v9 == 52 )
    {
      v9 = (unsigned __int8)v6[2];
      v7 = v9 | (unsigned int)v7;
    }
    v6 += (int)a3;
    goto LABEL_4;
  }
  if ( (unsigned int)dhcp_verbose > 1 )
    log_option_part_0("option found", v6, a3, v7);
  return v6 + 2;
}
