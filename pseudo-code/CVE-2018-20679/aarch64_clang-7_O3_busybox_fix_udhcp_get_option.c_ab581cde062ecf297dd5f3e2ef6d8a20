__int64 __fastcall udhcp_get_option(__int64 a1, __int64 a2)
{
  int v2; // w8
  __int64 v3; // x11
  int v4; // w15
  __int64 v5; // x14
  __int64 v6; // x17
  int v7; // w16
  __int64 v8; // x2
  __int64 v9; // x19
  unsigned __int8 *v10; // x20
  char v12[516]; // [xsp+Ch] [xbp-224h] BYREF

  v2 = 0;
  v3 = a1 + 240;
  v4 = 388;
  while ( 1 )
  {
    v5 = 0LL;
    v6 = 1LL;
    while ( 1 )
    {
      v7 = *(unsigned __int8 *)(v3 + v5);
      if ( *(_BYTE *)(v3 + v5) )
        break;
      --v6;
      ++v5;
      if ( v4 + (int)v6 < 2 )
        goto LABEL_22;
    }
    if ( v7 == 255 )
    {
      if ( (v2 & 0x101) == 1 )
      {
        v2 |= 0x101u;
        v4 = 128;
        v3 = a1 + 108;
        continue;
      }
      if ( (v2 & 0x202) == 2 )
      {
        v2 |= 0x202u;
        v4 = 64;
        v3 = a1 + 44;
        continue;
      }
      if ( (unsigned int)dhcp_verbose >= 3 )
        bb_error_msg("option 0x%02x not found", a2);
      return 0LL;
    }
    if ( v4 - (int)v5 < 2 )
      goto LABEL_22;
    v8 = *(unsigned __int8 *)(v3 + v5 + 1);
    v4 = v4 - 2 - v8 - v5;
    if ( (v4 & 0x80000000) != 0 )
      goto LABEL_22;
    if ( v7 == (_DWORD)a2 )
      break;
    if ( v7 == 52 && *(_BYTE *)(v3 + v5 + 1) )
      v2 |= *(unsigned __int8 *)(v3 + v5 + 2);
    v3 += v8 + 2 + v5;
    if ( v4 < 1 )
      goto LABEL_22;
  }
  if ( !*(_BYTE *)(v3 + v5 + 1) )
  {
LABEL_22:
    bb_error_msg("bad packet, malformed option field");
    return 0LL;
  }
  v9 = v3 + v5 + 2;
  if ( (unsigned int)dhcp_verbose > 1 )
  {
    v10 = (unsigned __int8 *)(v3 + v5);
    *(_BYTE *)bin2hex(v12, v3 + v5 + 2) = 0;
    bb_error_msg("%s: 0x%02x %s", "option found", *v10, v12);
  }
  return v9;
}
