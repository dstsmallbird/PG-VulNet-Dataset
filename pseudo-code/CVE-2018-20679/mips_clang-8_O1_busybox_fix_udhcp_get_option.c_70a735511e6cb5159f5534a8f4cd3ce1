int __fastcall udhcp_get_option(int a1, int a2)
{
  int v2; // $v0
  int v3; // $v1
  int v4; // $t3
  int v5; // $t2
  int v6; // $a0
  int v7; // $t6
  int v8; // $t4
  int v9; // $t5
  int v10; // $t7
  int v11; // $t6
  int v12; // $s0
  int v13; // $s0

  v2 = a1 + 108;
  v3 = a1 + 44;
  v4 = a1 + 240;
  v5 = 388;
  v6 = 0;
  while ( 2 )
  {
    while ( 2 )
    {
      while ( 1 )
      {
        v7 = 0;
        v8 = 0;
        while ( 1 )
        {
          v9 = v4 + v7;
          v10 = *(unsigned __int8 *)(v4 + v7);
          if ( *(_BYTE *)(v4 + v7) )
            break;
          --v8;
          ++v7;
          if ( v5 + v8 + 1 < 2 )
            goto LABEL_21;
        }
        if ( v10 == 255 )
          break;
        if ( v5 + v8 < 2 )
          goto LABEL_21;
        v11 = *(unsigned __int8 *)(v9 + 1);
        v5 = v5 - v11 + v8 - 2;
        if ( v5 < 0 )
          goto LABEL_21;
        if ( v10 == a2 )
        {
          if ( *(_BYTE *)(v9 + 1) )
          {
            v12 = v4 - v8;
            log_option("option found", v4 - v8, 255, 1);
            return v12 + 2;
          }
LABEL_21:
          bb_error_msg("bad packet, malformed option field", a2, 255, 1);
          return 0;
        }
        if ( v10 == 52 && *(_BYTE *)(v9 + 1) )
          v6 |= *(unsigned __int8 *)(v9 + 2);
        v4 = v4 + v11 - v8 + 2;
        if ( v5 <= 0 )
          goto LABEL_21;
      }
      if ( (v6 & 0x101) == 1 )
      {
        v6 |= 0x101u;
        v5 = 128;
        v4 = v2;
        continue;
      }
      break;
    }
    if ( (v6 & 0x202) == 2 )
    {
      v6 |= 0x202u;
      v5 = 64;
      v4 = v3;
      continue;
    }
    break;
  }
  v13 = 0;
  if ( (unsigned int)dhcp_verbose >= 3 )
    bb_error_msg("option 0x%02x not found", a2);
  return v13;
}
