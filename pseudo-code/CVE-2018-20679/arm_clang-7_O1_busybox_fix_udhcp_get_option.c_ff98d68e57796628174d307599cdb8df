int __fastcall udhcp_get_option(int a1, int a2)
{
  int v2; // r4
  int v3; // r8
  int v4; // r9
  int v5; // r6
  int v6; // r5
  int v7; // r10
  int v8; // r2
  int v9; // r7
  int v10; // r0
  int v11; // r3
  bool v12; // cc
  int v13; // r4

  v3 = a1 + 44;
  v4 = a1 + 108;
  v5 = a1 + 240;
  v6 = 388;
  v7 = 0;
  while ( 2 )
  {
    v8 = 2;
    v9 = 0;
    while ( 1 )
    {
      v10 = *(unsigned __int8 *)(v5 + v8 - 2);
      if ( *(_BYTE *)(v5 + v8 - 2) )
        break;
      --v9;
      ++v8;
      if ( v6 + v9 + 1 < 2 )
        goto LABEL_20;
    }
    if ( v10 == 255 )
    {
      if ( (v7 & 0x101) == 1 )
      {
        v7 |= 0x101u;
        v6 = 128;
        v5 = v4;
        goto LABEL_19;
      }
      if ( (v7 & 0x202) == 2 )
      {
        v7 |= 0x202u;
        v6 = 64;
        v5 = v3;
        goto LABEL_19;
      }
      v13 = 0;
      if ( (unsigned int)dhcp_verbose >= 3 )
        bb_error_msg("option 0x%02x not found", a2);
    }
    else
    {
      v11 = v6 + v9;
      v12 = v6 + v9 < 2;
      if ( v6 + v9 >= 2 )
      {
        v2 = v5 - v9;
        v11 = *(unsigned __int8 *)(v5 - v9 + 1);
        v6 = v6 - v11 + v9 - 2;
        v12 = v6 < 0;
      }
      if ( v12 )
        goto LABEL_20;
      if ( v10 != a2 )
      {
        if ( v10 == 52 && v11 )
          v7 |= *(unsigned __int8 *)(v5 + v8);
        v5 = v5 + v11 - v9 + 2;
LABEL_19:
        if ( v6 >= 1 )
          continue;
        goto LABEL_20;
      }
      if ( !v11 )
      {
LABEL_20:
        bb_error_msg("bad packet, malformed option field", a2, v8);
        return 0;
      }
      log_option("option found", v2);
      v13 = v2 + 2;
    }
    return v13;
  }
}
