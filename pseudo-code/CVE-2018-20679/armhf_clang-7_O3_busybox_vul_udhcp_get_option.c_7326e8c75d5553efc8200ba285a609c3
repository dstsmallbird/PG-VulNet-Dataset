int __fastcall udhcp_get_option(int a1, int a2, int a3)
{
  int v3; // r12
  int v4; // r8
  int v5; // r9
  int v6; // r6
  int v7; // r4
  int v8; // r10
  int v9; // r3
  int v10; // r7
  int v11; // r5
  int v12; // r0
  bool v13; // cc
  int v14; // r4
  char v16[546]; // [sp+6h] [bp-222h] BYREF

  v4 = a1 + 44;
  v5 = a1 + 108;
  v6 = a1 + 240;
  v7 = 388;
  v8 = 0;
  while ( 1 )
  {
    v9 = 2;
    v10 = 0;
    while ( 1 )
    {
      v11 = v6 + v9;
      v12 = *(unsigned __int8 *)(v6 + v9 - 2);
      if ( *(_BYTE *)(v6 + v9 - 2) )
        break;
      --v10;
      ++v9;
      if ( v7 + v10 + 1 < 2 )
        goto LABEL_20;
    }
    if ( v12 == 255 )
    {
      if ( (v8 & 0x101) == 1 )
      {
        v8 |= 0x101u;
        v7 = 128;
        v6 = v5;
        continue;
      }
      a3 = 514;
      if ( (v8 & 0x202) == 2 )
      {
        v8 |= 0x202u;
        v7 = 64;
        v6 = v4;
        continue;
      }
      v14 = 0;
      if ( (unsigned int)dhcp_verbose < 3 )
        return v14;
      bb_error_msg("option 0x%02x not found", a2);
      return 0;
    }
    a3 = v7 + v10;
    v13 = v7 + v10 < 2;
    if ( v7 + v10 >= 2 )
    {
      v3 = v6 - v10;
      a3 = *(unsigned __int8 *)(v6 - v10 + 1);
      v7 = v7 - a3 + v10 - 2;
      v13 = v7 < 0;
    }
    if ( v13 )
    {
LABEL_20:
      bb_error_msg("bad packet, malformed option field", a2, a3, v9);
      return 0;
    }
    if ( v12 == a2 )
      break;
    if ( v12 == 52 )
    {
      if ( a3 )
        v8 |= *(unsigned __int8 *)(v6 + v9);
    }
    v6 = v6 + a3 - v10 + 2;
    if ( v7 < 1 )
      goto LABEL_20;
  }
  v14 = v3 + 2;
  if ( (unsigned int)dhcp_verbose <= 1 )
    return v14;
  *(_BYTE *)bin2hex(v16, v3 + 2) = 0;
  bb_error_msg("%s: 0x%02x %s", "option found", *(unsigned __int8 *)(v11 - 2), v16);
  return v14;
}
