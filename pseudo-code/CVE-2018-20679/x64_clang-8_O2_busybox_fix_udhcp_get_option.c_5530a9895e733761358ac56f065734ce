__int64 __fastcall udhcp_get_option(__int64 a1, int a2)
{
  __int64 v2; // r15
  __int64 v3; // r8
  __int64 v4; // r9
  int v5; // eax
  int v6; // er11
  __int64 v7; // rdx
  __int64 v8; // rbx
  __int64 v9; // rcx
  __int64 v10; // rbx
  int v12; // er8
  int v13; // er9
  char v14[552]; // [rsp+0h] [rbp-228h] BYREF

  v2 = a1 + 240;
  v3 = a1 + 44;
  v4 = a1 + 108;
  v5 = 388;
  v6 = 0;
  while ( 2 )
  {
    LODWORD(v7) = 1;
    v8 = 0LL;
    while ( 1 )
    {
      v9 = *(unsigned __int8 *)(v2 + v8);
      if ( *(_BYTE *)(v2 + v8) )
        break;
      ++v8;
      LODWORD(v7) = v7 - 1;
      LODWORD(v9) = v7 + v5;
      if ( (int)v7 + v5 < 2 )
        goto LABEL_19;
    }
    if ( (_BYTE)v9 == 0xFF )
    {
      if ( (v6 & 0x101) == 1 )
      {
        v6 |= 0x101u;
        v5 = 128;
        v2 = a1 + 108;
        goto LABEL_18;
      }
      if ( (v6 & 0x202) == 2 )
      {
        v6 |= 0x202u;
        v5 = 64;
        v2 = a1 + 44;
        goto LABEL_18;
      }
      v10 = 0LL;
      if ( (unsigned int)dhcp_verbose >= 3 )
        bb_error_msg((unsigned int)"option 0x%02x not found", a2, v7, v9, v3, v4, v14[0]);
    }
    else
    {
      LODWORD(v7) = v5 - v8;
      if ( v5 - (int)v8 < 2 )
        goto LABEL_19;
      v7 = *(unsigned __int8 *)(v2 + v8 + 1);
      v5 = v5 - 2 - *(unsigned __int8 *)(v2 + v8 + 1) - v8;
      if ( v5 < 0 )
        goto LABEL_19;
      if ( (_DWORD)v9 != a2 )
      {
        if ( (_BYTE)v9 == 52 && (_BYTE)v7 )
        {
          LODWORD(v9) = *(unsigned __int8 *)(v2 + v8 + 2);
          v6 |= v9;
        }
        v2 += v8 + v7 + 2;
LABEL_18:
        if ( v5 > 0 )
          continue;
        goto LABEL_19;
      }
      if ( !(_BYTE)v7 )
      {
LABEL_19:
        v10 = 0LL;
        bb_error_msg((unsigned int)"bad packet, malformed option field", a2, v7, v9, v3, v4, v14[0]);
        return v10;
      }
      if ( (unsigned int)dhcp_verbose >= 2 )
      {
        *(_BYTE *)bin2hex(v14, v2 + v8 + 2, v7, v9, v3, v4) = 0;
        bb_error_msg(
          (unsigned int)"%s: 0x%02x %s",
          (unsigned int)"option found",
          *(unsigned __int8 *)(v2 + v8),
          (unsigned int)v14,
          v12,
          v13,
          v14[0]);
      }
      v10 = v2 + v8 + 2;
    }
    return v10;
  }
}
