__int64 __fastcall tftp_connect(_QWORD *a1, _BYTE *a2)
{
  __int64 v2; // rax
  int *v3; // rax
  int v4; // eax
  int v5; // ecx
  int v6; // er8
  int v7; // er9
  __int64 v9; // [rsp+0h] [rbp-C0h]
  char v10[136]; // [rsp+10h] [rbp-B0h] BYREF
  int v12; // [rsp+9Ch] [rbp-24h]
  __int64 v13; // [rsp+A0h] [rbp-20h]
  _BYTE *v14; // [rsp+A8h] [rbp-18h]
  _QWORD *v15; // [rsp+B0h] [rbp-10h]

  v15 = a1;
  v14 = a2;
  v12 = 512;
  v2 = Curl_ccalloc(1LL, 368LL);
  a1[167] = v2;
  v13 = v2;
  if ( !v2 )
    return 27;
  if ( *(_QWORD *)(*v15 + 1976LL) )
  {
    v12 = *(_QWORD *)(*v15 + 1976LL);
    if ( v12 > 65464 || v12 < 8 )
      return 71;
  }
  if ( !*(_QWORD *)(v13 + 352) && (*(_QWORD *)(v13 + 352) = Curl_ccalloc(1LL, v12 + 4)) == 0LL )
    return 27;
  if ( *(_QWORD *)(v13 + 360) || (*(_QWORD *)(v13 + 360) = Curl_ccalloc(1LL, v12 + 4)) != 0LL )
  {
    Curl_conncontrol(v15, 1LL);
    *(_QWORD *)(v13 + 16) = v15;
    *(_DWORD *)(v13 + 24) = *(_DWORD *)(*(_QWORD *)(v13 + 16) + 624LL);
    *(_DWORD *)v13 = 0;
    *(_DWORD *)(v13 + 8) = -100;
    *(_DWORD *)(v13 + 340) = v12;
    *(_DWORD *)(v13 + 344) = v12;
    *(_WORD *)(v13 + 72) = *(_DWORD *)(v15[14] + 4LL);
    tftp_set_timeouts(v13);
    if ( ((*(_QWORD *)((char *)v15 + 948) >> 25) & 1) == 0 )
    {
      if ( bind(*(_DWORD *)(v13 + 24), (const struct sockaddr *)(v13 + 72), *(_DWORD *)(v15[14] + 16LL)) )
      {
        v9 = *v15;
        v3 = __errno_location();
        v4 = Curl_strerror((unsigned int)*v3, v10, 128LL);
        Curl_failf(v9, (unsigned int)"bind() failed; %s", v4, v5, v6, v7, v9);
        return 7;
      }
      *(_QWORD *)((char *)v15 + 948) = *(_QWORD *)((char *)v15 + 948) & 0xFFFFFFFFFDFFFFFFLL | 0x2000000;
    }
    Curl_pgrsStartNow(*v15);
    *v14 = 1;
    return 0;
  }
  return 27;
}
