__int64 __fastcall tftp_connect(_QWORD *a1, _BYTE *a2)
{
  __int64 v2; // x0
  int *v3; // x0
  __int64 v4; // x0
  __int64 v6; // [xsp+10h] [xbp-150h]
  char v7[128]; // [xsp+A4h] [xbp-BCh] BYREF
  int v9; // [xsp+128h] [xbp-38h]
  int v10; // [xsp+12Ch] [xbp-34h]
  __int64 v11; // [xsp+130h] [xbp-30h]
  _BYTE *v12; // [xsp+138h] [xbp-28h]
  _QWORD *v13; // [xsp+140h] [xbp-20h]

  v13 = a1;
  v12 = a2;
  v10 = 512;
  v2 = Curl_ccalloc(1LL, 368LL);
  v13[148] = v2;
  v11 = v2;
  if ( !v2 )
    return 27;
  if ( *(_QWORD *)(*v13 + 1976LL) )
  {
    v10 = *(_QWORD *)(*v13 + 1976LL);
    if ( v10 > 65464 || v10 < 8 )
      return 71;
  }
  v9 = v10;
  if ( v10 < 512 )
    v9 = 512;
  if ( !*(_QWORD *)(v11 + 352) && (*(_QWORD *)(v11 + 352) = Curl_ccalloc(1LL, v9 + 4)) == 0LL )
    return 27;
  if ( *(_QWORD *)(v11 + 360) || (*(_QWORD *)(v11 + 360) = Curl_ccalloc(1LL, v9 + 4)) != 0LL )
  {
    Curl_conncontrol(v13, 1LL);
    *(_QWORD *)(v11 + 16) = v13;
    *(_DWORD *)(v11 + 24) = *(_DWORD *)(*(_QWORD *)(v11 + 16) + 624LL);
    *(_DWORD *)v11 = 0;
    *(_DWORD *)(v11 + 8) = -100;
    *(_DWORD *)(v11 + 340) = 512;
    *(_DWORD *)(v11 + 344) = v10;
    *(_WORD *)(v11 + 72) = *(_DWORD *)(v13[14] + 4LL);
    tftp_set_timeouts(v11);
    if ( ((*(_QWORD *)((char *)v13 + 892) >> 25) & 1) == 0 )
    {
      if ( bind(*(_DWORD *)(v11 + 24), (const struct sockaddr *)(v11 + 72), *(_DWORD *)(v13[14] + 16LL)) )
      {
        v6 = *v13;
        v3 = __errno_location();
        v4 = Curl_strerror((unsigned int)*v3, v7, 128LL);
        Curl_failf(v6, "bind() failed; %s", v4);
        return 7;
      }
      *(_QWORD *)((char *)v13 + 892) = *(_QWORD *)((char *)v13 + 892) & 0xFFFFFFFFFDFFFFFFLL | 0x2000000;
    }
    Curl_pgrsStartNow(*v13);
    *v12 = 1;
    return 0;
  }
  return 27;
}
