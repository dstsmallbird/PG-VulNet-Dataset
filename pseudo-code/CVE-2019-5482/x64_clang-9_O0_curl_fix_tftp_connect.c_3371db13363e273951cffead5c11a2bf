__int64 __fastcall tftp_connect(_QWORD *a1, _BYTE *a2)
{
  __int64 v2; // rax
  int *v3; // rax
  int v4; // eax
  int v5; // ecx
  int v6; // er8
  int v7; // er9
  __int64 v9; // [rsp+8h] [rbp-B8h]
  char v10[132]; // [rsp+10h] [rbp-B0h] BYREF
  int v12; // [rsp+98h] [rbp-28h]
  int v13; // [rsp+9Ch] [rbp-24h]
  __int64 v14; // [rsp+A0h] [rbp-20h]
  _BYTE *v15; // [rsp+A8h] [rbp-18h]
  _QWORD *v16; // [rsp+B0h] [rbp-10h]

  v16 = a1;
  v15 = a2;
  v13 = 512;
  v2 = Curl_ccalloc(1LL, 368LL);
  a1[167] = v2;
  v14 = v2;
  if ( !v2 )
    return 27;
  if ( *(_QWORD *)(*v16 + 1976LL) )
  {
    v13 = *(_QWORD *)(*v16 + 1976LL);
    if ( v13 > 65464 || v13 < 8 )
      return 71;
  }
  v12 = v13;
  if ( v13 < 512 )
    v12 = 512;
  if ( !*(_QWORD *)(v14 + 352) && (*(_QWORD *)(v14 + 352) = Curl_ccalloc(1LL, v12 + 4)) == 0LL )
    return 27;
  if ( *(_QWORD *)(v14 + 360) || (*(_QWORD *)(v14 + 360) = Curl_ccalloc(1LL, v12 + 4)) != 0LL )
  {
    Curl_conncontrol(v16, 1LL);
    *(_QWORD *)(v14 + 16) = v16;
    *(_DWORD *)(v14 + 24) = *(_DWORD *)(*(_QWORD *)(v14 + 16) + 624LL);
    *(_DWORD *)v14 = 0;
    *(_DWORD *)(v14 + 8) = -100;
    *(_DWORD *)(v14 + 340) = 512;
    *(_DWORD *)(v14 + 344) = v13;
    *(_WORD *)(v14 + 72) = *(_DWORD *)(v16[14] + 4LL);
    tftp_set_timeouts(v14);
    if ( ((*(_QWORD *)((char *)v16 + 948) >> 25) & 1) == 0 )
    {
      if ( bind(*(_DWORD *)(v14 + 24), (const struct sockaddr *)(v14 + 72), *(_DWORD *)(v16[14] + 16LL)) )
      {
        v9 = *v16;
        v3 = __errno_location();
        v4 = Curl_strerror((unsigned int)*v3, v10, 128LL);
        Curl_failf(v9, (unsigned int)"bind() failed; %s", v4, v5, v6, v7);
        return 7;
      }
      *(_QWORD *)((char *)v16 + 948) = *(_QWORD *)((char *)v16 + 948) & 0xFFFFFFFFFDFFFFFFLL | 0x2000000;
    }
    Curl_pgrsStartNow(*v16);
    *v15 = 1;
    return 0;
  }
  return 27;
}
