int __fastcall tftp_connect(_DWORD *a1, _BYTE *a2)
{
  int v3; // r5
  int *v4; // r0
  const char *v5; // r0
  int v9; // [sp+8h] [bp+8h]
  int v10; // [sp+Ch] [bp+Ch]
  int v11; // [sp+14h] [bp+14h] BYREF

  v9 = 512;
  a1[188] = Curl_ccalloc(1, 336);
  v10 = a1[188];
  if ( !v10 )
    return 27;
  if ( *(_DWORD *)(*a1 + 1576) )
  {
    v9 = *(_DWORD *)(*a1 + 1576);
    if ( v9 > 65464 || v9 <= 7 )
      return 71;
  }
  if ( !*(_DWORD *)(v10 + 328) )
  {
    *(_DWORD *)(v10 + 328) = Curl_ccalloc(1u, v9 + 4);
    if ( !*(_DWORD *)(v10 + 328) )
      return 27;
  }
  if ( *(_DWORD *)(v10 + 332) || (*(_DWORD *)(v10 + 332) = Curl_ccalloc(1u, v9 + 4)) != 0 )
  {
    Curl_conncontrol(a1, 1);
    *(_DWORD *)(v10 + 16) = a1;
    *(_DWORD *)(v10 + 20) = *(_DWORD *)(*(_DWORD *)(v10 + 16) + 420);
    *(_DWORD *)v10 = 0;
    *(_DWORD *)(v10 + 8) = -100;
    *(_DWORD *)(v10 + 320) = v9;
    *(_DWORD *)(v10 + 324) = v9;
    *(_WORD *)(v10 + 52) = *(_DWORD *)(a1[20] + 4);
    tftp_set_timeouts(v10);
    if ( (*((_BYTE *)a1 + 591) & 2) == 0 )
    {
      if ( bind(*(_DWORD *)(v10 + 20), (const struct sockaddr *)(v10 + 52), *(_DWORD *)(a1[20] + 16)) )
      {
        v3 = *a1;
        v4 = _errno_location();
        v5 = (const char *)Curl_strerror(*v4, &v11, 128);
        Curl_failf(v3, "bind() failed; %s", v5);
        return 7;
      }
      *((_BYTE *)a1 + 591) |= 2u;
    }
    Curl_pgrsStartNow(*a1);
    *a2 = 1;
    return 0;
  }
  return 27;
}
