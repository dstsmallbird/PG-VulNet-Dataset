__int64 __fastcall tftp_connect(_QWORD *a1, _BYTE *a2)
{
  __int64 v2; // x0
  int *v3; // x0
  const char *v4; // x0
  __int64 v6; // [xsp+8h] [xbp-B8h]
  char v7[128]; // [xsp+18h] [xbp-A8h] BYREF
  int v9; // [xsp+9Ch] [xbp-24h]
  __int64 v10; // [xsp+A0h] [xbp-20h]
  _BYTE *v11; // [xsp+A8h] [xbp-18h]
  _QWORD *v12; // [xsp+B0h] [xbp-10h]

  v12 = a1;
  v11 = a2;
  v9 = 512;
  v2 = Curl_ccalloc(1LL, 368LL);
  v12[148] = v2;
  v10 = v2;
  if ( !v2 )
    return 27;
  if ( *(_QWORD *)(*v12 + 1976LL) )
  {
    v9 = *(_QWORD *)(*v12 + 1976LL);
    if ( v9 > 65464 || v9 < 8 )
      return 71;
  }
  if ( !*(_QWORD *)(v10 + 352) && (*(_QWORD *)(v10 + 352) = Curl_ccalloc(1LL, v9 + 4)) == 0LL )
    return 27;
  if ( *(_QWORD *)(v10 + 360) || (*(_QWORD *)(v10 + 360) = Curl_ccalloc(1LL, v9 + 4)) != 0LL )
  {
    Curl_conncontrol(v12, 1LL);
    *(_QWORD *)(v10 + 16) = v12;
    *(_DWORD *)(v10 + 24) = *(_DWORD *)(*(_QWORD *)(v10 + 16) + 624LL);
    *(_DWORD *)v10 = 0;
    *(_DWORD *)(v10 + 8) = -100;
    *(_DWORD *)(v10 + 340) = v9;
    *(_DWORD *)(v10 + 344) = v9;
    *(_WORD *)(v10 + 72) = *(_DWORD *)(v12[14] + 4LL);
    tftp_set_timeouts(v10);
    if ( ((*(_QWORD *)((char *)v12 + 892) >> 25) & 1) == 0 )
    {
      if ( bind(*(_DWORD *)(v10 + 24), (const struct sockaddr *)(v10 + 72), *(_DWORD *)(v12[14] + 16LL)) )
      {
        v6 = *v12;
        v3 = __errno_location();
        v4 = (const char *)Curl_strerror((unsigned int)*v3, v7, 128LL);
        Curl_failf(v6, "bind() failed; %s", v4);
        return 7;
      }
      *(_QWORD *)((char *)v12 + 892) = *(_QWORD *)((char *)v12 + 892) & 0xFFFFFFFFFDFFFFFFLL | 0x2000000;
    }
    Curl_pgrsStartNow(*v12);
    *v11 = 1;
    return 0;
  }
  return 27;
}
